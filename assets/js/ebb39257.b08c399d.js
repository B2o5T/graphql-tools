(self.webpackChunk_graphql_tools_website=self.webpackChunk_graphql_tools_website||[]).push([[6159],{5318:function(e,a,t){"use strict";t.d(a,{Zo:function(){return u},kt:function(){return d}});var n=t(7378);function r(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function l(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function o(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?l(Object(t),!0).forEach((function(a){r(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function s(e,a){if(null==e)return{};var t,n,r=function(e,a){if(null==e)return{};var t,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)t=l[n],a.indexOf(t)>=0||(r[t]=e[t]);return r}(e,a);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)t=l[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var i=n.createContext({}),p=function(e){var a=n.useContext(i),t=a;return e&&(t="function"==typeof e?e(a):o(o({},a),e)),t},u=function(e){var a=p(e.components);return n.createElement(i.Provider,{value:a},e.children)},c={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},m=n.forwardRef((function(e,a){var t=e.components,r=e.mdxType,l=e.originalType,i=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),m=p(t),d=r,h=m["".concat(i,".").concat(d)]||m[d]||c[d]||l;return t?n.createElement(h,o(o({ref:a},u),{},{components:t})):n.createElement(h,o({ref:a},u))}));function d(e,a){var t=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var l=t.length,o=new Array(l);o[0]=m;var s={};for(var i in a)hasOwnProperty.call(a,i)&&(s[i]=a[i]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var p=2;p<l;p++)o[p]=t[p];return n.createElement.apply(null,o)}return n.createElement.apply(null,t)}m.displayName="MDXCreateElement"},6607:function(e,a,t){"use strict";t.r(a),t.d(a,{frontMatter:function(){return o},metadata:function(){return s},toc:function(){return i},default:function(){return u}});var n=t(9603),r=t(120),l=(t(7378),t(5318)),o={id:"scalars",title:"Custom scalars and enums",description:"Add custom scalar and enum types to your graphql-tools generated schema."},s={unversionedId:"scalars",id:"scalars",isDocsHomePage:!1,title:"Custom scalars and enums",description:"Add custom scalar and enum types to your graphql-tools generated schema.",source:"@site/docs/scalars.md",sourceDirName:".",slug:"/scalars",permalink:"/docs/scalars",editUrl:"https://github.com/ardatan/graphql-tools/edit/master/website/docs/scalars.md",version:"current",frontMatter:{id:"scalars",title:"Custom scalars and enums",description:"Add custom scalar and enum types to your graphql-tools generated schema."},sidebar:"someSidebar",previous:{title:"Resolvers composition",permalink:"/docs/resolvers-composition"},next:{title:"Mocking",permalink:"/docs/mocking"}},i=[{value:"Custom scalars",id:"custom-scalars",children:[{value:"Using a package",id:"using-a-package",children:[]},{value:"Custom <code>GraphQLScalarType</code> instance",id:"custom-graphqlscalartype-instance",children:[]}]},{value:"Custom scalar examples",id:"custom-scalar-examples",children:[{value:"Date as a scalar",id:"date-as-a-scalar",children:[]},{value:"Validations",id:"validations",children:[]}]},{value:"Enums",id:"enums",children:[{value:"Internal values",id:"internal-values",children:[]}]}],p={toc:i};function u(e){var a=e.components,t=(0,r.Z)(e,["components"]);return(0,l.kt)("wrapper",(0,n.Z)({},p,t,{components:a,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"The GraphQL specification includes the following default scalar types: ",(0,l.kt)("inlineCode",{parentName:"p"},"Int"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"Float"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"String"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"Boolean")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"ID"),". While this covers most of the use cases, often you need to support custom atomic data types (e.g. Date), or you want a version of an existing type that does some validation. To enable this, GraphQL allows you to define custom scalar types. Enumerations are similar to custom scalars, but their values can only be one of a pre-defined list of strings."),(0,l.kt)("h2",{id:"custom-scalars"},"Custom scalars"),(0,l.kt)("p",null,"To define a custom scalar you simply add it to the schema string with the following notation:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"scalar MyCustomScalar\n")),(0,l.kt)("p",null,"Afterwards, you have to define the behavior of your ",(0,l.kt)("inlineCode",{parentName:"p"},"MyCustomScalar")," custom scalar by passing an instance of the ",(0,l.kt)("a",{parentName:"p",href:"http://graphql.org/graphql-js/type/#graphqlscalartype"},(0,l.kt)("inlineCode",{parentName:"a"},"GraphQLScalarType"))," class in the ",(0,l.kt)("a",{parentName:"p",href:"/docs/resolvers/#resolver-map"},"resolver map"),". This instance can be defined in a ",(0,l.kt)("a",{parentName:"p",href:"#using-a-package"},"dependency package")," or ",(0,l.kt)("a",{parentName:"p",href:"#custom-graphqlscalartype-instance"},"in your own code"),"."),(0,l.kt)("p",null,"For more information about GraphQL's type system, please refer to the ",(0,l.kt)("a",{parentName:"p",href:"http://graphql.org/graphql-js/type/"},"official documentation")," or to the ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mugli/learning-graphql/blob/master/7.%20Deep%20Dive%20into%20GraphQL%20Type%20System.md"},"Learning GraphQL")," tutorial."),(0,l.kt)("p",null,"Note that most of popular GraphQL clients does not currently have a way to automatically interpret custom scalars, so there's no way to automatically reverse the serialization on the client."),(0,l.kt)("h3",{id:"using-a-package"},"Using a package"),(0,l.kt)("p",null,"Here, we'll take the ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/Urigo/graphql-scalars"},"graphql-scalars")," package as an example to demonstrate what can be done. This npm package defines a JSON GraphQL scalar type."),(0,l.kt)("p",null,"Add the ",(0,l.kt)("inlineCode",{parentName:"p"},"graphql-scalars")," package to your project's dependencies :"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"$ npm install --save graphql-scalars\n")),(0,l.kt)("p",null,"In your JavaScript code, require the type defined by in the npm package and use it :"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"import { makeExecutableSchema } from '@graphql-tools/schema';\nimport { GraphQLJSON } from 'graphql-scalars';\n\nconst schemaString = `\n\nscalar JSON\n\ntype Foo {\n  aField: JSON\n}\n\ntype Query {\n  foo: Foo\n}\n\n`;\n\nconst resolveFunctions = {\n  JSON: GraphQLJSON\n};\n\nconst jsSchema = makeExecutableSchema({ typeDefs: schemaString, resolvers: resolveFunctions });\n")),(0,l.kt)("p",null,"Remark : ",(0,l.kt)("inlineCode",{parentName:"p"},"GraphQLJSON")," is a ",(0,l.kt)("a",{parentName:"p",href:"http://graphql.org/graphql-js/type/#graphqlscalartype"},(0,l.kt)("inlineCode",{parentName:"a"},"GraphQLScalarType"))," instance."),(0,l.kt)("p",null,"For a set of popular scalar types that are ready to reuse, try out the ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/urigo/graphql-scalars"},"GraphQL Scalars npm library"),"."),(0,l.kt)("h3",{id:"custom-graphqlscalartype-instance"},"Custom ",(0,l.kt)("inlineCode",{parentName:"h3"},"GraphQLScalarType")," instance"),(0,l.kt)("p",null,"If needed, you can define your own ",(0,l.kt)("a",{parentName:"p",href:"http://graphql.org/graphql-js/type/#graphqlscalartype"},"GraphQLScalarType")," instance. This can be done the following way :"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"import { GraphQLScalarType } from 'graphql';\nimport { makeExecutableSchema } from '@graphql-tools/schema';\n\nconst myCustomScalarType = new GraphQLScalarType({\n  name: 'MyCustomScalar',\n  description: 'Description of my custom scalar type',\n  serialize(value) {\n    let result;\n    // Implement your own behavior here by setting the 'result' variable\n    return result;\n  },\n  parseValue(value) {\n    let result;\n    // Implement your own behavior here by setting the 'result' variable\n    return result;\n  },\n  parseLiteral(ast) {\n    switch (ast.kind) {\n      // Implement your own behavior here by returning what suits your needs\n      // depending on ast.kind\n    }\n  }\n});\n\nconst schemaString = `\n\nscalar MyCustomScalar\n\ntype Foo {\n  aField: MyCustomScalar\n}\n\ntype Query {\n  foo: Foo\n}\n\n`;\n\nconst resolverFunctions = {\n  MyCustomScalar: myCustomScalarType\n};\n\nconst jsSchema = makeExecutableSchema({\n  typeDefs: schemaString,\n  resolvers: resolverFunctions,\n});\n")),(0,l.kt)("h2",{id:"custom-scalar-examples"},"Custom scalar examples"),(0,l.kt)("p",null,"Let's look at a couple of examples to demonstrate how a custom scalar type can be defined."),(0,l.kt)("h3",{id:"date-as-a-scalar"},"Date as a scalar"),(0,l.kt)("p",null,"The goal is to define a ",(0,l.kt)("inlineCode",{parentName:"p"},"Date")," data type for returning ",(0,l.kt)("inlineCode",{parentName:"p"},"Date")," values from the database. Let's say we're using a MongoDB driver that uses the native JavaScript ",(0,l.kt)("inlineCode",{parentName:"p"},"Date")," data type. The ",(0,l.kt)("inlineCode",{parentName:"p"},"Date")," data type can be easily serialized as a number using the ",(0,l.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/getTime"},(0,l.kt)("inlineCode",{parentName:"a"},"getTime()")," method"),". Therefore, we would like our GraphQL server to send and receive ",(0,l.kt)("inlineCode",{parentName:"p"},"Date"),"s as numbers when serializing to JSON. This number will be resolved to a ",(0,l.kt)("inlineCode",{parentName:"p"},"Date")," on the server representing the date value. On the client, the user can simply create a new date from the received numeric value."),(0,l.kt)("p",null,"The following is the implementation of the ",(0,l.kt)("inlineCode",{parentName:"p"},"Date")," data type. First, the schema:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"scalar Date\n\ntype MyType {\n   created: Date\n}\n")),(0,l.kt)("p",null,"Next, the resolver:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"import { GraphQLScalarType } from 'graphql';\nimport { Kind } from 'graphql/language';\n\nconst resolverMap = {\n  Date: new GraphQLScalarType({\n    name: 'Date',\n    description: 'Date custom scalar type',\n    parseValue(value) {\n      return new Date(value); // value from the client\n    },\n    serialize(value) {\n      return value.getTime(); // value sent to the client\n    },\n    parseLiteral(ast) {\n      if (ast.kind === Kind.INT) {\n        return new Date(+ast.value) // ast value is always in string format\n      }\n      return null;\n    },\n  }),\n};\n")),(0,l.kt)("h3",{id:"validations"},"Validations"),(0,l.kt)("p",null,"In this example, we follow the ",(0,l.kt)("a",{parentName:"p",href:"http://graphql.org/docs/api-reference-type-system/"},"official GraphQL documentation")," for the scalar datatype. Let's say that you have a database field that should only contain odd numbers. First, the schema:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"scalar Odd\n\ntype MyType {\n    oddValue: Odd\n}\n")),(0,l.kt)("p",null,"Next, the resolver:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"import { GraphQLScalarType } from 'graphql';\nimport { Kind } from 'graphql/language';\n\nfunction oddValue(value) {\n  return value % 2 === 1 ? value : null;\n}\n\nconst resolverMap = {\n  Odd: new GraphQLScalarType({\n    name: 'Odd',\n    description: 'Odd custom scalar type',\n    parseValue: oddValue,\n    serialize: oddValue,\n    parseLiteral(ast) {\n      if (ast.kind === Kind.INT) {\n        return oddValue(parseInt(ast.value, 10));\n      }\n      return null;\n    },\n  }),\n};\n")),(0,l.kt)("h2",{id:"enums"},"Enums"),(0,l.kt)("p",null,"An Enum is similar to a scalar type, but it can only be one of several values defined in the schema. Enums are most useful in a situation where you need the user to pick from a prescribed list of options, and they will auto-complete in tools like GraphiQL."),(0,l.kt)("p",null,"In the schema language, an enum looks like this:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-graphql"},"enum AllowedColor {\n  RED\n  GREEN\n  BLUE\n}\n")),(0,l.kt)("p",null,"You can use it in your schema anywhere you could use a scalar:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-graphql"},"type Query {\n  favoriteColor: AllowedColor # As a return value\n  avatar(borderColor: AllowedColor): String # As an argument\n}\n")),(0,l.kt)("p",null,"Then, you query it like this:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-graphql"},"query {\n  avatar(borderColor: RED)\n}\n")),(0,l.kt)("p",null,"If you want to pass the enum value as a variable, use a string in your JSON, like so:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-graphql"},"query MyAvatar($color: AllowedColor) {\n  avatar(borderColor: $color)\n}\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'{\n  "color": "RED"\n}\n')),(0,l.kt)("p",null,"Putting it all together:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"const typeDefs = `\n  enum AllowedColor {\n    RED\n    GREEN\n    BLUE\n  }\n\n  type Query {\n    favoriteColor: AllowedColor # As a return value\n    avatar(borderColor: AllowedColor): String # As an argument\n  }\n`;\n\nconst resolvers = {\n  Query: {\n    favoriteColor: () => 'RED',\n    avatar: (root, args) => {\n      // args.borderColor is 'RED', 'GREEN', or 'BLUE'\n    },\n  }\n};\n\nconst schema = makeExecutableSchema({ typeDefs, resolvers });\n")),(0,l.kt)("h3",{id:"internal-values"},"Internal values"),(0,l.kt)("p",null,"Often, you might have a different value for the enum in your code than in the public API. So maybe in the API we call it ",(0,l.kt)("inlineCode",{parentName:"p"},"RED"),", but inside our resolvers we want to use ",(0,l.kt)("inlineCode",{parentName:"p"},"#f00")," instead. That's why you can use the ",(0,l.kt)("inlineCode",{parentName:"p"},"resolvers")," argument to ",(0,l.kt)("inlineCode",{parentName:"p"},"makeExecutableSchema")," to add custom values to your enum that only show up internally:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"const resolvers = {\n  AllowedColor: {\n    RED: '#f00',\n    GREEN: '#0f0',\n    BLUE: '#00f',\n  }\n};\n")),(0,l.kt)("p",null,"These don't change the public API at all, but they do allow you to use that value instead of the schema value in your resolvers, like so:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"const resolvers = {\n  AllowedColor: {\n    RED: '#f00',\n    GREEN: '#0f0',\n    BLUE: '#00f',\n  },\n  Query: {\n    favoriteColor: () => '#f00',\n    avatar: (root, args) => {\n      // args.favoriteColor is '#f00', '#0f0', or '#00f'\n    },\n  }\n};\n")),(0,l.kt)("p",null,"Most of the time, you don't need to use this feature of enums unless you're interoperating with some other library which already expects its values in a different form."))}u.isMDXComponent=!0}}]);